<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="view_crm_stage_color_settings_form" model="ir.ui.view">
        <field name="name">crm.stage.color.settings.form</field>
        <field name="model">crm.stage.color.settings</field>
        <field name="arch" type="xml">
            <form string="CRM Stage Color Settings">
                <sheet>
                    <group>
                        <field name="stage_id"/>
                        <field name="color"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_crm_stage_color_settings_tree" model="ir.ui.view">
        <field name="name">crm.stage.color.settings.tree</field>
        <field name="model">crm.stage.color.settings</field>
        <field name="arch" type="xml">
            <tree string="CRM Stage Color Settings">
                <field name="stage_id"/>
                <field name="color"/>
            </tree>
        </field>
    </record>

    <menuitem id="menu_crm_stage_color_settings"
              name="CRM Stage Color Settings"
              parent="crm.menu_crm_config"
              action="action_crm_stage_color_settings"/>

    <record id="action_crm_stage_color_settings" model="ir.actions.act_window">
        <field name="name">CRM Stage Color Settings</field>
        <field name="res_model">crm.stage.color.settings</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="view_crm_lead_kanban_color" model="ir.ui.view">
        <field name="name">crm.lead.kanban.color</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_leads_view_kanban"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@class='o_kanban_record']" position="attributes">
                <attribute name="t-attf-style">
                    <t t-esc="'background-color:' + (record.stage_id.raw_value in record._get_stage_color() ? record._get_stage_color()[record.stage_id.raw_value] : 'white')"/>
                </attribute>
            </xpath>
        </field>
    </record>
</odoo>
